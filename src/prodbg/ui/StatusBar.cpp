#include "StatusBar.h"
#include <QLabel>
#include <QStatusBar>
#include <QMainWindow>
#include <QString>

///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

namespace prodbg
{

extern QMainWindow* g_mainWindow;

///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

enum
{
	LabelCount = 2,
};

///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

static QLabel* s_labels[LabelCount];

///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

void StatusBar_init()
{
	QStatusBar* status = g_mainWindow->statusBar();

	for (int i = 0; i < LabelCount; ++i)
	{
		s_labels[i] = new QLabel;
		status->addPermanentWidget(s_labels[i]);
	}
}

///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

void StatusBar_setText(int slot, const char* format, ...) 
{
    va_list ap;
    char buffer[2048];

	if (slot >= LabelCount || (slot < 0))
		return;

    va_start(ap, format);
	vsprintf(buffer, format, ap);

	s_labels[slot]->setText(QString::fromUtf8(buffer));

    va_end(ap);
}

///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////


}

